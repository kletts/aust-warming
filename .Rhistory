import cdsapi
import datetime
import netCDF4
import numpy as np
import pandas as pd
import sys
import os
from dotenv import load_dotenv
load_dotenv()
import cdsapi
import datetime
import netCDF4
import numpy as np
import pandas as pd
import sys
import os
from dotenv import load_dotenv
load_dotenv()
ct = datetime.date.today() + datetime.timedelta(days=-30)
ct2 = datetime.date.today() + datetime.timedelta(days=-60)
ct
ct2
dataset = "reanalysis-era5-land-monthly-means"
request = {
"product_type": ["monthly_averaged_reanalysis"],
"variable": ["2m_temperature"],
"year": [ ct.year ],
"month": [ ct.month, ct2.month ],
"time": ["00:00"],
"data_format": "netcdf",
"download_format": "unarchived",
"area": [-9, 112, -44, 160]
}
target = 'download.nc'
client = cdsapi.Client(
url="https://cds.climate.copernicus.eu/api",
key=os.getenv('CDSAPIKEY'))
client.retrieve(dataset, request, target)
obs = netCDF4.Dataset('download.nc', 'r')
obs
ct3 = datetime.date.today() + datetime.timedelta(days=-90)
request = {
"product_type": ["monthly_averaged_reanalysis"],
"variable": ["2m_temperature"],
"year": [ ct.year ],
"month": [ ct.month, ct2.month, ct3.month ],
"time": ["00:00"],
"data_format": "netcdf",
"download_format": "unarchived",
"area": [-9, 112, -44, 160]
}
target = 'download.nc'
client.retrieve(dataset, request, target)
obs = netCDF4.Dataset('download.nc', 'r')
obs
data = obs.variables['t2m']
data
obs.variables
data
obs.dimensions
collections = client.get_collections(sortby="update")
datetime.date.today()
datetime.date.today().day()
datetime.date.today().day
if datetime.date.today().day < 25:
ct = datetime.date.today() + datetime.timedelta(days=-60)
else:
ct = datetime.date.today() + datetime.timedelta(days=-30)
reticulate::repl_python()
